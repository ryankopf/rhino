<%= form_with(model: page) do |form| %>
  <% if page.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(page.errors.count, "error") %> prohibited this challenge from being saved:</h2>
      <ul>
        <% page.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= form.label :title %>
    <%= form.text_field :title, class: 'form-control' %>
  </div>

  <div>
    <a href="#" onclick="$('.advanced').toggle();return false;">Advanced Options</a>
  </div>

  <div class="advanced">
    <div class="form-group">
      <%= form.label :seo_title %>
      <%= form.text_field :seo_title, class: 'form-control' %>
    </div>

    <div class="form-group">
      <%= form.label :url %>
      <%= form.text_field :url, class: 'form-control' %>
    </div>

    <div class="form-group">
      <%= form.label :redirect_to %>
      <%= form.text_field :redirect_to, class: 'form-control' %>
    </div>

    <div class="form-group">
      <%= form.label :css_classes %>
      <%= form.text_field :css_classes, class: 'form-control' %>
    </div>
  </div>

  <div class="form-group">
    <%= form.label :description %>
    <%= form.text_field :description, class: 'form-control' %>
  </div>

  <div class="actions">
    <%#= form.submit %>
    <button type="submit" class="btn btn-primary">Submit</button>
  </div>
<% end %>
<script>
  var FormMagic = {}
  FormMagic.initialize = function () {
    if ($("#page_seo_title").val() == $("#page_title").val()) {
      $("#page_seo_title").addClass('follows')
    }
    if ($("#page_url").val() == FormMagic.title_to_url()) {
      $("#page_url").addClass('follows')
    }
    $("#page_title").on("change",FormMagic.change_title);
    $("#page_seo_title").on("keypress",function() {$("#page_seo_title").removeClass('follows')});
    $("#page_url").on("keypress",function() {$("#page_url").removeClass('follows')});
  }
  FormMagic.change_title = function () {
    if ($("#page_seo_title").attr('class').indexOf('follows') >= 0) {
      $("#page_seo_title").val($("#page_title").val());
    }
    if ($("#page_url").attr('class').indexOf('follows') >= 0) {
      $("#page_url").val(FormMagic.title_to_url());
    }
  }
  FormMagic.title_to_url = function () {
    var url = $("#page_title").val().toLowerCase();
    url = url.replace(/[^a-z0-9]/gi, '-');
    return url;
  };
  (function(){var r = setInterval(function(){"undefined"!=typeof $&&(clearInterval(r),FormMagic.initialize())},300);})();
</script>